<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Calculadora Fantasy</title>
  <meta name="theme-color" content="#0e1117">
  <meta name="msapplication-navbutton-color" content="#0e1117">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="#0e1117">
  <link rel="icon" type="image/png" href="logo.png">
  <link rel="apple-touch-icon" type="image/png" href="logo.png">
  <link rel="apple-touch-icon-precomposed" type="image/png" href="logo.png">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="google-adsense-account" content="ca-pub-7891666149137266">
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-QXF4YKPSMD"></script>
  <link rel="preconnect" href="https://calculadorafantasy.streamlit.app/~/+/?embed=true" crossorigin>
  <link rel="dns-prefetch" href="https://calculadorafantasy.streamlit.app/~/+/?embed=true">
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-QXF4YKPSMD');
  </script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html, body {
      width: 100%;
      height: 100%;
      background: rgb(14, 17, 23);
      font-family: 'Segoe UI', sans-serif;
      color: white;
      overflow-x: hidden;
      overflow-y: auto;
    }

    /* Only zoom for desktop screens */
    @media (min-width: 1024px) {
      html, body {
        zoom: 1.3;
      }
    }

    .wrapper {
      width: 100%;
      height: 100%;
      position: relative;
    }

    /* LANDING */
    .landing {
      position: relative;
      min-height: 10svh;
      width: 100%;
      height: 100%;
      background: rgb(14, 17, 23);
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      align-items: center;
      z-index: 3;
      transition: opacity 0.4s ease;
      padding: 6rem 1rem 4rem;
      text-align: center;
    }

    .landing.hidden {
      opacity: 0;
      pointer-events: none;
    }

    .lang {
      position: absolute;
      top: 2rem;
      left: 3rem;
    }

    .lang-btn {
      position: static;
      padding: 2px 4px;
      font-size: 0.7rem;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      transition: background 0.3s ease;
    }

    .lang-btn:hover {
      background: rgb(255, 76, 76);
    }
    .lang-btn.active {
      border: 1.5px solid rgb(200, 50, 50);
    }

    .logo {
      position: absolute;
      top: 2rem;
      right: 3rem;
    }

    .logo img {
      height: 50px;
    }

    h1 {
      position: static;
      top: 7rem;
      font-size: 2rem;
      margin-bottom: 0;
    }

    h4 {
      position: static;
      top: 10rem;
      padding: 5px;
      font-size: 1.05rem;
      font-weight: 400;
      color: rgba(255, 255, 255, 0.7);
      margin-bottom: 2rem;
    }

    .enter-button {
      position: static;
      top: 12rem;
      padding: 12px 24px;
      font-size: 1.1rem;
      background: rgb(255, 76, 76);
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: background 0.3s ease;
      margin-bottom: 2rem;
      margin-top: 1rem;
    }

    .enter-button:hover {
      background: rgb(200, 50, 50);
    }

    .slide {
      position: static;
      top: 18rem;
      max-width: 600px;
      margin-top: 2rem;
      animation: fadeIn 0.5s ease;
    }

    .slide h2 {
      font-size: 1.3rem;
      margin-bottom: 0.5rem;
    }

    .slide p {
      font-size: 1rem;
      opacity: 0.9;
    }

    .slide img {
      margin-top: 3rem;
      max-width: 100%;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.4);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .slide img:hover {
      transform: scale(1.02);
      box-shadow: 0 0 15px rgba(255, 76, 76, 0.8);
    }

    .slider-controls {
      position: relative;
      top: -50%;
      width: 100%;
      display: flex;
      justify-content: space-between;
      transform: translateY(-50%);
    }

    .slider-button {
      background: rgba(255, 76, 76, 0.7);
      border: none;
      color: white;
      font-size: 1.5rem;
      padding: 6px 12px;
      border-radius: 5px;
      cursor: pointer;
      transition: background 0.3s ease;
    }

    .slider-button:hover {
      background: rgba(255, 76, 76, 1);
    }

    .slide-content {
      opacity: 1;
      transition: opacity 0.8s ease;
    }

    .slide-content.fade-out {
      opacity: 0;
    }

    .slide-content.fade-in {
      opacity: 1;
    }

    footer {
      position: static;
      bottom: 2rem;
      width: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.9rem;
      color: rgba(255, 255, 255, 0.7);
      padding-bottom: 2rem;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* IFRAME */
    .iframe-container {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100dvh;
      background: rgb(14, 17, 23);
      z-index: 1;
    }

    iframe {
      width: 100%;
      height: 100%;
      border: none;
      opacity: 0;
      transition: opacity 0.4s ease;
    }

    iframe.loaded {
      opacity: 1;
    }

  .loading-overlay {
    position: fixed; inset: 0;
    background: rgba(14,17,23,.95);
    display: none; align-items: center; justify-content: center;
    z-index: 2; color: #fff; font-size: 1.1rem;
  }
  .spinner {
    width: 32px; height: 32px; border: 3px solid #555; border-top-color: #ff4c4c;
    border-radius: 50%; animation: spin 0.9s linear infinite; margin-right: 10px;
  }
  @keyframes spin { to { transform: rotate(360deg); } }
  </style>
</head>
<body>
  <div class="wrapper">
    <!-- LANDING -->
    <div class="landing" id="landing">
      <!-- Language -->
      <div class="lang">
        <div class="lang-toggle" aria-label="Language">
          <button class="lang-btn" id="btnES" onclick="setLang('es')">
            Espa√±ol <img src="https://flagcdn.com/es.svg" alt="ES" style="width:18px; vertical-align:middle;">
          </button>
          <button class="lang-btn" id="btnEN" onclick="setLang('en')">
            English <img src="https://flagcdn.com/gb.svg" alt="EN" style="width:18px; vertical-align:middle;">
          </button>
        </div>
      </div>
      <!-- LOGO -->
      <div class="logo">
        <img src="logo.png" alt="Logo Calculadora Fantasy">
      </div>

      <h1 id="t-title">Bienvenido a la Calculadora Fantasy</h1>
      <h4 id="t-subtitle">Con soporte para: LaLiga Fantasy &amp; Biwenger</h4>
      <button class="enter-button" id="t-enter" onclick="enterApp()">Empezar a calcular</button>

      <div class="slide" id="slide" onmouseover="pauseSlider()" onmouseout="resumeSlider()">
        <div class="slide-content" id="slideContent">
          <!-- Contenido inicial se carga con JS -->
        </div>
        <!-- se rellena con JS -->
        <div class="slider-controls">
          <button class="slider-button" onclick="prevSlide()">&#10094;</button>
          <button class="slider-button" onclick="nextSlide()">&#10095;</button>
        </div>
      </div>

      <footer>
        <p id="t-footer">
          üì© <span id="t-contact-label">Contacto</span>:
          <a href="mailto:calculadora.fantasy@gmail.com">calculadora.fantasy@gmail.com</a> |
          <a href="#" onclick="openPrivacy()" style="color: rgba(255,255,255,0.7);" id="t-privacy-link">Pol√≠tica de Privacidad</a>
        </p>
      </footer>

      <!-- Privacy modal -->
      <div id="privacyModal" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.8); z-index:1000; padding:2rem; overflow:auto;">
        <div style="max-width:800px; margin:auto; background:#1e1e1e; padding:2rem; border-radius:8px;">
          <h2 id="t-privacy-title">Pol√≠tica de Privacidad</h2>
          <p id="t-privacy-p1">
            En Calculadora Fantasy respetamos tu privacidad y nos comprometemos a proteger tus datos personales.
            Este sitio web no recopila datos personales sin tu consentimiento y no comparte informaci√≥n con terceros salvo obligaci√≥n legal.
          </p>
          <p id="t-privacy-p2">
            Para m√°s informaci√≥n o ejercer tus derechos de acceso, rectificaci√≥n o supresi√≥n, escr√≠benos a
            <a href="mailto:calculadora.fantasy@gmail.com" style="color:rgb(255,76,76);">calculadora.fantasy@gmail.com</a>.
          </p>
          <button onclick="closePrivacy()" id="t-privacy-close" style="margin-top:1rem; padding:10px 20px; background:rgb(255, 76, 76); border:none; border-radius:6px; color:white; cursor:pointer;">Cerrar</button>
        </div>
      </div>
    </div>

    <!-- APP loader -->
    <div id="loading" class="loading-overlay">
      <div class="spinner"></div> <span id="t-loading">Cargando jugadores‚Ä¶</span>
    </div>
<!--    &lt;!&ndash; APP &ndash;&gt;-->
<!--    <div class="iframe-container">-->
<!--      <iframe-->
<!--        id="appFrame"-->
<!--        src="https://calculadorafantasy.streamlit.app/~/+/?embed=true"-->
<!--        allowfullscreen-->
<!--        onload="this.classList.add('loaded')">-->
<!--      </iframe>-->
<!--    </div>-->
  </div>

  <script>
    // --- Simple i18n ----------------------------------------------------------
    const I18N = {
      es: {
        title: "Bienvenido a la Calculadora Fantasy",
        subtitle: "Con soporte para: LaLiga Fantasy & Biwenger",
        enter: "Empezar a calcular",
        contact_label: "Contacto",
        privacy_link: "Pol√≠tica de Privacidad",
        privacy_title: "Pol√≠tica de Privacidad",
        privacy_p1: "En Calculadora Fantasy respetamos tu privacidad y nos comprometemos a proteger tus datos personales. Este sitio web no recopila datos personales sin tu consentimiento y no comparte informaci√≥n con terceros salvo obligaci√≥n legal.",
        privacy_p2: "Para m√°s informaci√≥n o ejercer tus derechos de acceso, rectificaci√≥n o supresi√≥n, escr√≠benos a",
        privacy_close: "Cerrar",
        loading: "Cargando jugadores‚Ä¶",
        slides: [
          { title: "üí∞ Mejores 11s con presupuesto", desc: "Calcula la mejor alineaci√≥n posible seg√∫n tu presupuesto disponible.",            img: "img/presupuesto.png" },
          { title: "‚öΩ Mi mejor 11 posible",         desc: "Elige tus jugadores disponibles y descubre tu mejor once ideal.",                 img: "img/once.png" },
          { title: "üìã Lista de jugadores",          desc: "Consulta estad√≠sticas, precios y puntuaciones esperadas de todos los jugadores.", img: "img/lista.png" },
          { title: "üìà Analizar mi mercado",         desc: "Selecciona varios jugadores para compararlos entre ellos.",                       img: "img/mercado.png" },
        ]
      },
      en: {
        title: "Welcome to the Fantasy Calculator",
        subtitle: "Supports: LaLiga Fantasy & Biwenger",
        enter: "Start calculating",
        contact_label: "Contact",
        privacy_link: "Privacy Policy",
        privacy_title: "Privacy Policy",
        privacy_p1: "At Fantasy Calculator we respect your privacy and are committed to protecting your personal data. This site does not collect personal data without your consent and does not share information with third parties except when legally required.",
        privacy_p2: "For more information or to exercise your rights of access, rectification or erasure, write to",
        privacy_close: "Close",
        loading: "Loading players‚Ä¶",
        slides: [
          { title: "üí∞ Best lineups by budget",     desc: "Compute the best possible lineup based on your available budget.",   img: "img/budget.png" },
          { title: "‚öΩ My best possible lineup",    desc: "Pick your available players and get your ideal starting eleven.",    img: "img/lineup.png" },
          { title: "üìã Players list",               desc: "See stats, prices and expected points for every player.",            img: "img/list.png" },
          { title: "üìà Analyze my market",          desc: "Select several players to compare them against each other.",         img: "img/market.png" },
        ]
      }
    };

    function getQueryLang(){
      const p = new URLSearchParams(location.search);
      const q = (p.get("lang") || "").toLowerCase();
      return (q === "en" || q === "es") ? q : null;
    }
    function guessBrowserLang(){
      const n = navigator.language || navigator.userLanguage || "es";
      return n.toLowerCase().startsWith("en") ? "en" : "es";
    }
    function saveLang(lang){
      try { localStorage.setItem("lang", lang); } catch(_) {}
    }
    function loadLang(){
      try { return localStorage.getItem("lang"); } catch(_) { return null; }
    }

    let LANG = getQueryLang() || loadLang() || guessBrowserLang();

    function applyLangToDom(){
      const T = I18N[LANG] || I18N.es;
      document.documentElement.lang = LANG;

      // Top texts
      document.getElementById("t-title").textContent = T.title;
      document.getElementById("t-subtitle").textContent = T.subtitle;
      document.getElementById("t-enter").textContent = T.enter;

      // Footer & privacy
      document.getElementById("t-contact-label").textContent = T.contact_label;
      document.getElementById("t-privacy-link").textContent = T.privacy_link;
      document.getElementById("t-privacy-title").textContent = T.privacy_title;
      document.getElementById("t-privacy-p1").textContent = T.privacy_p1;
      // p2 is text + email link
      const p2 = document.getElementById("t-privacy-p2");
      p2.firstChild && p2.removeChild(p2.firstChild);
      p2.insertAdjacentText("afterbegin", T.privacy_p2 + " ");
      document.getElementById("t-privacy-close").textContent = T.privacy_close;

      // Loading overlay
      document.getElementById("t-loading").textContent = T.loading;

      // Slides content
      slides = T.slides.slice(); // replace the global slides array
      currentSlide = 0;
      renderSlide(currentSlide);

      // Toggle active button
      document.getElementById("btnES").classList.toggle("active", LANG==="es");
      document.getElementById("btnEN").classList.toggle("active", LANG==="en");

      // Keep URL shareable with ?lang=
      const url = new URL(location.href);
      url.searchParams.set("lang", LANG);
      history.replaceState(null, "", url.toString());
    }

    function setLang(lang){
      if (lang !== "es" && lang !== "en") return;
      LANG = lang;
      saveLang(LANG);
      applyLangToDom();
    }
    // -------------------------------------------------------------------------

    // Slides (placeholder; overwritten by applyLangToDom on first run)
    let slides = I18N[LANG].slides.slice();
    let currentSlide = 0;
    let intervalId;
    const slideContainer = document.getElementById('slide');

    function renderSlide(index) {
      const slide = slides[index];
      const content = document.getElementById('slideContent');

      // Fade out
      content.classList.remove('fade-in');
      content.classList.add('fade-out');

      // Espera a que termine el fade-out antes de cambiar contenido
      setTimeout(() => {
        content.innerHTML = `
          <h2>${slide.title}</h2>
          <p>${slide.desc}</p>
          <img src="${slide.img}" alt="${slide.title}">
        `;

        // Fade in
        content.classList.remove('fade-out');
        content.classList.add('fade-in');
      }, 300);
    }

    function nextSlide() { currentSlide = (currentSlide + 1) % slides.length; renderSlide(currentSlide); }
    function prevSlide() { currentSlide = (currentSlide - 1 + slides.length) % slides.length; renderSlide(currentSlide); }
    function startSlider() { renderSlide(currentSlide); intervalId = setInterval(nextSlide, 6000); }
    function pauseSlider() { clearInterval(intervalId); }
    function resumeSlider() { intervalId = setInterval(nextSlide, 6000); }

    function enterApp() {
      document.getElementById('loading').style.display = 'flex';
      document.getElementById('landing').classList.add('hidden');
      const mode = "landing";
      let path;
      if (window.location.protocol === "file:") { path = `app/index.html`; }
      else { path = `app/`; }
      const target = new URL(path, window.location.href);
      console.log("Redirecting to:", target.toString());
      // propagate language to the app path
      target.searchParams.set("lang", LANG);
      setTimeout(() => { window.location.href = target.toString(); }, 200);
    }

    startSlider();
    applyLangToDom(); // initial render in the right language

    window.addEventListener('pageshow', (e) => {
      const fromHistory = e.persisted || (performance.getEntriesByType('navigation')[0]?.type === 'back_forward');
      if (fromHistory) {
        document.getElementById('loading').style.display = 'none';
        document.getElementById('landing').classList.remove('hidden');
      }
    });

    function openPrivacy() { document.getElementById('privacyModal').style.display = 'block'; }
    function closePrivacy() { document.getElementById('privacyModal').style.display = 'none'; }
  </script>
</body>
</html>
